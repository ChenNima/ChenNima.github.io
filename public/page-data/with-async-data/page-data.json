{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/with-async-data","result":{"data":{"markdownRemark":{"html":"<p>åœ¨Reactä¸­ï¼Œæ— è®ºæ˜¯å¦ä½¿ç”¨äº†Reduxæˆ–å…¶ä»–çŠ¶æ€ç®¡ç†æ¡†æ¶ï¼Œéƒ½æ— æ³•é¿å…åœ¨ç»„ä»¶ä¸­å¤„ç†å¼‚æ­¥è¯·æ±‚ã€‚åœ¨ä¸ä½¿ç”¨<code>React Hooks</code>çš„æƒ…å†µä¸‹ï¼Œå…¶å…¸å‹çš„æµç¨‹ä¸ºï¼š</p>\n<ul>\n<li>åœ¨<code>componentDidMount</code>ä¸­å‘èµ·å¼‚æ­¥è¯·æ±‚</li>\n<li>è°ƒç”¨<code>setState</code>åœ¨stateä¸­ç»´æŠ¤è¯·æ±‚çš„loadingçŠ¶æ€ï¼Œå¹¶æ ¹æ®æ­¤çŠ¶æ€æ¸²æŸ“åŠ è½½åŠ¨ç”»</li>\n<li>åœ¨å¼‚æ­¥è¯·æ±‚resolveçš„æ—¶å€™è°ƒç”¨<code>setState</code>å°†æ•°æ®æ”¾åˆ°stateä¸­ï¼Œå¹¶å°†loadingçŠ¶æ€ç½®ä¸ºfalse</li>\n<li>å¦‚æœå¼‚æ­¥è¯·æ±‚å­˜åœ¨å¼‚å¸¸ï¼Œåˆ™éœ€è¦å¤„ç†å¼‚å¸¸å¹¶æ¸²æŸ“å¯¹åº”çš„å¼‚å¸¸çŠ¶æ€</li>\n</ul>\n<p>å¯ä»¥çœ‹åˆ°æ•´ä¸ªæµç¨‹éå¸¸çç¢ï¼Œå¦‚æœé¡¹ç›®ä¸­æœ‰å¾ˆå¤šå¼‚æ­¥ç»„ä»¶ï¼Œåˆ™æ¯ä¸ªç»„ä»¶éƒ½è¦é‡å¤åœ°å†™ä¸€æ¬¡ä»¥ä¸Šæµç¨‹ã€‚\nåŒæ—¶ï¼Œè¿™ä¸ªæµç¨‹å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p>\n<ol>\n<li>å¦‚æœç»„ä»¶<code>unmount</code>ä¹‹åå¼‚æ­¥è¯·æ±‚æ‰resolveï¼Œé‚£ä¹ˆå¾ˆæœ‰å¯èƒ½æ”¶åˆ°<code>Warning: Canâ€™t call setState (or forceUpdate) on an unmounted component. </code>è­¦å‘Š</li>\n<li>åœ¨å®ç°ç±»ä¼¼äº<code>typeahead</code>ç±»å‹çš„autocompleteç»„ä»¶æˆ–æ˜¯å…¶ä»–çš„ä¼šé¢‘ç¹å‘ç”Ÿå¼‚æ­¥è¯·æ±‚çš„ç»„ä»¶ä¸­ï¼Œæœ‰å¯èƒ½ä¼šå‘ç”Ÿè¯·æ±‚å…ˆå‘ååˆ°çš„é—®é¢˜ï¼šå…ˆå‘çš„è¯·æ±‚æ¯”åå‘çš„è¯·æ±‚æ›´æ…¢resolveï¼Œå¯¼è‡´æœ€åä¸€æ¬¡æ¸²æŸ“ç»“æœä½¿ç”¨äº†ä¹‹å‰å·²ç»è¿‡æœŸçš„è¾“å…¥</li>\n<li>ç»„ä»¶é™¤è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ä¹‹å¤–è¿˜éœ€è¦ç»´æŠ¤æ•´å¥—å¼‚æ­¥è¯·æ±‚æµç¨‹ã€‚è¿åäº†å‡½æ•°å¼ç¼–ç¨‹ä¸­<code>â€œçº¯â€</code>çš„æ¦‚å¿µã€‚ä¸€ä¸ªä¼˜ç§€çš„çº¯ç»„ä»¶åº”è¯¥ä»…æœ‰è¾“å…¥å’Œè¾“å‡ºï¼šé‡å¤åŒä¸€ä¸ªè¾“å…¥åº”è¯¥å¹‚ç­‰åœ°è¿”å›åŒä¸€ä¸ªæ¸²æŸ“ç»“æœ</li>\n</ol>\n<p>ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰å¼‚æ­¥é€»è¾‘æŠ½è±¡åˆ°ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰ä¸­ï¼Œå¹¶ä¿æŒçœŸæ­£æ¸²æŸ“ä¸šåŠ¡é€»è¾‘çš„ç»„ä»¶è¶³å¤Ÿ<code>â€œçº¯â€</code>ï¼Œå¹¶ä¸”ä½¿ç”¨Typescriptä½¿propsç±»å‹æ›´ä¸ºæ¸…æ™°ã€‚\næˆ‘ä»¬æŠŠè¿™ä¸ªHOCå«åš<code>withAsyncData</code>,æºç å¯ä»¥åœ¨<a href=\"https://github.com/ChenNima/blog-example/blob/master/front-end/withAsyncData.tsx\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è¿™é‡Œ</a>çœ‹åˆ°ã€‚</p>\n<p>ç»è¿‡åŒ…è£…åçš„ç»„ä»¶æ€»ä½“ç»“æ„å¦‚ä¸‹å›¾ï¼š\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 571px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a32c40223fd89494c691be608c55cfa8/ffaf9/arch.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 85.71428571428571%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAARABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAECAwX/xAAWAQEBAQAAAAAAAAAAAAAAAAACAAH/2gAMAwEAAhADEAAAAfaxrJuqCqMqFn//xAAXEAEBAQEAAAAAAAAAAAAAAAABABEg/9oACAEBAAEFAmE2Y5//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAXEQEAAwAAAAAAAAAAAAAAAAABABAR/9oACAECAQE/AcLJ/8QAFxAAAwEAAAAAAAAAAAAAAAAAAAEwMf/aAAgBAQAGPwIxw//EABwQAQABBAMAAAAAAAAAAAAAAAEAEBEhQTFxkf/aAAgBAQABPyFFsi9RmxCbQI5t5DipP//aAAwDAQACAAMAAAAQP88+/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAEQIf/aAAgBAwEBPxDRRn//xAAYEQEBAQEBAAAAAAAAAAAAAAABACExUf/aAAgBAgEBPxA8Gccm4v/EABwQAQEAAQUBAAAAAAAAAAAAAAERABAhMUFRof/aAAgBAQABPxCwAd4oCbtEPriptgoLF9LlQo8BpPLpwz//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"æ€»ä½“ç»“æ„\"\n        title=\"\"\n        src=\"/static/a32c40223fd89494c691be608c55cfa8/ffaf9/arch.jpg\"\n        srcset=\"/static/a32c40223fd89494c691be608c55cfa8/e52aa/arch.jpg 175w,\n/static/a32c40223fd89494c691be608c55cfa8/70ebb/arch.jpg 350w,\n/static/a32c40223fd89494c691be608c55cfa8/ffaf9/arch.jpg 571w\"\n        sizes=\"(max-width: 571px) 100vw, 571px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h1>ğŸ”¨ æ„å»ºHOC</h1>\n<h3><strong>1. åˆå§‹çŠ¶æ€</strong></h3>\n<pre><code class=\"language-jsx\">const WithAsyncData = Child => (\n  class WithAsyncData extends Component {\n    mounted = false;\n    state = {\n      isLoadingData: false\n    }\n  }\n);\n</code></pre>\n<p>æˆ‘ä»¬çš„HOCæ¥å—ä¸€ä¸ªReact Componentä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªç»è¿‡åŒ…è£¹çš„Componentã€‚åˆå§‹æˆ‘ä»¬æ‹¥æœ‰ä¸¤ä¸ªçŠ¶æ€ï¼šmountedå’ŒisLoadingDataã€‚é¡¾åæ€ä¹‰ä»–ä»¬æ˜¯ç”¨æ¥ç»´æŠ¤ç»„ä»¶mountçŠ¶æ€å’Œæ•°æ®loadingçŠ¶æ€çš„ã€‚ç”±äºmountçŠ¶æ€å¹¶ä¸ç›´æ¥å½±å“æ¸²æŸ“ç»“æœè€Œåªæ˜¯ç”¨æ¥æŒ‡å¯¼æ˜¯å¦åº”è¯¥è°ƒç”¨<code>setState</code>ï¼Œæˆ‘ä»¬é€‰æ‹©æŠŠå®ƒæ”¾åœ¨<code>this</code>ä¸Šè€Œä¸æ˜¯<code>state</code>é‡Œã€‚</p>\n<h3><strong>2. æ¥å—å¼‚æ­¥æ•°æ®</strong></h3>\n<pre><code class=\"language-jsx\">static getDerivedStateFromProps(props, state) {\n  // cleanDataè¿™ä¸ªå±æ€§ç”¨æ¥è¡¨ç¤ºæ˜¯å¦åœ¨æ¯æ¬¡æ›´æ–°æ•°æ®ä¹‹åå°†ä¸Šæ¬¡çš„æ•°æ®ä¿å­˜åœ¨lastDataè¿™ä¸ªstateä¸­ï¼Œä¸»è¦ç”¨äºinfinityScrollè¿™ç§åœºæ™¯ã€‚\n  const { data, cleanData } = props;\n  const { lastData } = state;\n  // å¦‚æœdataæ²¡æœ‰æ”¹å˜ï¼Œç›´æ¥è·³è¿‡\n  if( data === lastData ) {\n    return null;\n  }\n  // å¦‚æœdataæ˜¯åŒæ­¥æ•°æ®ï¼Œé‚£ä¹ˆå°†isLoadingDataç½®ä¸ºfalseï¼Œç›´æ¥å°†dataä¼ é€’ç»™æ¸²æŸ“ç»„ä»¶\n  if (!isThenable(data)) {\n    return {\n      lastData: data,\n      data,\n      dataPromise: null,\n      isLoadingData: false\n    };\n  // å¦‚æœdataæ˜¯å¼‚æ­¥è¯·æ±‚ï¼ˆè¿™é‡Œç”¨thenableè¡¨ç¤ºï¼‰ï¼Œé‚£ä¹ˆå°†isLoadingDataç½®ä¸ºtrueï¼Œå‡†å¤‡è¯·æ±‚å¼‚æ­¥æ•°æ®\n  } else {\n    const newState = {\n      lastData: data,\n      dataPromise: data,\n      isLoadingData: true\n    };\n    if(cleanData) {\n      newState.data = null;\n    }\n    return newState;\n  }\n}\n</code></pre>\n<p>ä½¿ç”¨<code>getDerivedStateFromProps</code>é’©å­å¯ä»¥åœ¨æ¯æ¬¡æ¸²æŸ“ä¹‹å‰æ¥æ”¶å¤–éƒ¨ä¼ è¿›æ¥çš„<code>data</code>ï¼Œåœ¨è¿™é‡Œ<code>data</code>å¯ä»¥æ˜¯ä¸€ä¸ªåŒæ­¥æ•°æ®ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¼‚æ­¥<code>Promise</code>ã€‚</p>\n<h3><strong>3. å¤„ç†å¼‚æ­¥æ•°æ®</strong></h3>\n<pre><code class=\"language-jsx\">componentDidMount() {\n  // è®°å½•ç»„ä»¶mountçŠ¶æ€\n  this.mounted = true;\n  if (this.state.dataPromise) {\n    this.resolveAsyncData(this.state.dataPromise);\n  }\n}\n\ncomponentDidUpdate(prevProps, prevState) {\n  // ä»…åœ¨dataPromiseæ”¹å˜çš„æƒ…å†µä¸‹æ‰resolveå¼‚æ­¥æ•°æ®\n  if (this.state.dataPromise &#x26;&#x26; (this.state.dataPromise !== prevState.dataPromise)) {\n    this.resolveAsyncData(this.state.dataPromise);\n  }\n}\n\nshouldKeepResult(dataPromise) {\n  // ä»…ä»…åœ¨å½“å‰Promiseæ˜¯ç»„ä»¶æ¥æ”¶åˆ°çš„æœ€åä¸€ä¸ªPromiseï¼Œå¹¶ä¸”ç»„ä»¶å°šæœªunmountçš„æƒ…å†µä¸‹æ‰ä¼šå°†dataçœŸæ­£resolveç»™æ¸²æŸ“ç»„ä»¶\n  return dataPromise === this.state.dataPromise &#x26;&#x26; this.mounted;\n}\n\nasync resolveAsyncData(dataPromise) {\n  try {\n    const data = await dataPromise;\n    // åœ¨æ­¤å¤„é—­åŒ…è®¿é—®dataPromiseï¼Œå³å¯å°†resolveçš„Promiseä¸ç»„ä»¶æœ€åæ¥æ”¶åˆ°çš„Promiseè¿›è¡Œå¯¹æ¯”\n    if (this.shouldKeepResult(dataPromise)) {\n      if(this.props.onDataReady) {\n        // åœ¨æ•°æ®resolveä¹‹åï¼Œå¤–éƒ¨ç»„ä»¶çš„å›è°ƒé’©å­\n        this.props.onDataReady(data);\n      }\n      this.setState({\n        data,\n        isLoadingData: false,\n        dataPromise: null,\n        dataError: null\n      });\n    }\n  } catch (error) {\n    if (this.shouldKeepResult(dataPromise)) {\n      if(this.props.onDataError) {\n        // åœ¨æ•°æ®resolve å¤±è´¥ä¹‹åï¼Œå¤–éƒ¨ç»„ä»¶çš„å›è°ƒé’©å­\n        this.props.onDataError(error);\n      }\n      this.setState({\n        dataError: error,\n        isLoadingData: false,\n        dataPromise: null\n      });\n    }\n  }\n}\n// ç»„ä»¶unmountä¹‹å‰è®°å½•çŠ¶æ€\ncomponentWillUnmount() {\n  this.mounted = false;\n}\n</code></pre>\n<h3><strong>4. ä¼ é€’æ•°æ®ç»™å­ç»„ä»¶</strong></h3>\n<pre><code class=\"language-jsx\">render() {\n  const props = {\n    // å¯¹å­ç»„ä»¶æ¥è¯´ï¼Œdataæ˜¯åŒæ­¥æ•°æ®ã€‚å°†å¤–éƒ¨ä¼ å…¥çš„promiseåˆ é™¤å¹¶æ›¿æ¢ä¸ºåŒæ­¥æ•°æ®ï¼ŒåŒæ—¶å°†loadingçŠ¶æ€ç­‰stateä¹Ÿä¸€åŒä¼ é€’\n    ...omit(this.props, ['data']),\n    ...this.state\n  };\n  return &#x3C;Child {...props} />;\n}\n</code></pre>\n<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†æ•´ä¸ªHOCçš„æ„å»ºï¼Œå®é™…ä½¿ç”¨æ—¶æ•ˆæœå¦‚ä¸‹</p>\n<pre><code class=\"language-jsx\">const promise = new Promise&#x3C;string>(resolve => setTimeout(() => {resolve('hello world');}, 200));\n\nconst RenderComponent = withAsyncData(({ data, isLoadingData }: { data: string, isLoadingData?: boolean }) => (\n  &#x3C;div>\n    {isLoadingData &#x26;&#x26; &#x3C;span>loading&#x3C;/span>}\n    {!isLoadingData &#x26;&#x26; data &#x26;&#x26; &#x3C;span>{data}&#x3C;/span>}\n  &#x3C;/div>\n));\nconst ParentComponent = () => (\n  &#x3C;RenderComponent data={promise} />\n);\n</code></pre>\n<p><strong>å¯ä»¥çœ‹åˆ°ï¼Œå¤–å±‚<code>ParentComponent</code>ä»…ä»…è´Ÿè´£å°†å¼‚æ­¥æ•°æ®ä¼ é€’ç»™äº†å­ç»„ä»¶ï¼Œè€Œå†…éƒ¨ç»„ä»¶<code>RenderComponent</code>ä¹Ÿä»…ä»…æ˜¯å°†é™æ€å†…å®¹æ¸²æŸ“æˆäº†domã€‚æ•´ä¸ªå¼‚æ­¥æ•°æ®çš„resolveå’ŒçŠ¶æ€ç»´æŒéƒ½æ”¾åœ¨äº†HOCå†…éƒ¨ã€‚ç»“æ„æ­£å¦‚ä¸€å¼€å§‹çš„å›¾æ‰€æè¿°</strong></p>\n<h1>ğŸš€ æ”¹å†™ä¸ºTypescript</h1>\n<p>ç»è¿‡HOCåŒ…è£¹åçš„ç»„ä»¶ï¼Œç”±æ¥æ”¶åŒæ­¥æ•°æ®å˜ä¸ºæ¥æ”¶å¼‚æ­¥æ•°æ®ï¼Œå…¶Propsçš„typeä¹Ÿå‘ç”Ÿäº†ç›¸åº”çš„æ”¹å˜ã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸€ç›®çš„ï¼Œæˆ‘ä»¬å°†HOCè¿›è¡Œä»¥ä¸‹æ”¹å†™ï¼š</p>\n<pre><code class=\"language-jsx\">interface PropsType&#x3C;T> {\n  data: PromiseLike&#x3C;T> | T | null;\n  onDataReady?: (data: T) => void;\n  onDataError?: (e: any) => void;\n  cleanData?: boolean;\n}\n\ninterface StateType&#x3C;T> {\n  dataPromise?: PromiseLike&#x3C;T> | null;\n  data?: T;\n  lastData?: T;\n  isLoadingData: boolean;\n  dataError?: any;\n}\n\nfunction withAsyncData&#x3C;ChildPropsType extends { data?: any }>(Child: ComponentType&#x3C;ChildPropsType>) {\n  // çœŸæ­£çš„data typeæ˜¯ç”±å­ç»„ä»¶å†³å®šçš„\n  type Data = ChildPropsType['data'];\n  // å°†data typeä»å­ç»„ä»¶çš„propsä¸­åˆ é™¤ï¼Œ HOCæ¥æ”¶çš„å¼‚æ­¥æ•°æ®æœ€ç»ˆtypeä¸ºPromiseLike&#x3C;Data>\n  type MixedPropsType = Omit&#x3C;ChildPropsType, 'data'> &#x26; PropsType&#x3C;Data>;\n\n  return class WithAsyncData extends Component&#x3C;MixedPropsType, StateType&#x3C;Data>> {\n    ...\n  }\n</code></pre>\n<ul>\n<li>ä½¿ç”¨æ³›å‹<code>&#x3C;ChildPropsType extends { data?: any }></code>ä»¥åŠè‡ªåŠ¨ç±»å‹åˆ¤æ–­æ¥å°†è¦æ±‚å­ç»„ä»¶å¿…é¡»æ¥å—<code>data</code>å±æ€§</li>\n<li><code>Omit&#x3C;ChildPropsType, 'data'></code>å°†data typeä»å­ç»„ä»¶çš„propsä¸­åˆ é™¤ã€‚åœ¨è¾ƒæ–°çš„typescriptä¸­<code>Omit</code>å¸®åŠ©ç±»å‹çš„å®šä¹‰åœ¨<code>node_modules/typescript/lib/lib.es5.d.ts</code>ä¸­ã€‚å¦‚æœtypescriptç‰ˆæœ¬è¾ƒæ—§æ²¡æœ‰è¯¥å¸®åŠ©ç±»å‹ï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œpolyfillï¼š</li>\n</ul>\n<pre><code class=\"language-jsx\">declare type Omit&#x3C;T, K> = Pick&#x3C;T, Exclude&#x3C;keyof T, K>>;\n</code></pre>\n<p>å¦‚ä¸‹å›¾ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨é”™è¯¯çš„promise typeï¼Œé‚£ä¹ˆTypescriptå°±ä¼šæŠ¥é”™ã€‚</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/64cdeb47ab36016f60e175cf6e0fce07/d30ee/error-example.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.571428571428573%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAy0lEQVR42o2QXZLCIBCEcxkThEACDAhE1PL+d+ptsm7VPvrw1dT8dQ9Mfu+IMWPzBSE2+Nzg0hNODmzxDk2u5QUbOjQx+QkbK6JUmL1AuYxlu2FhVDZhkviApANpCIUC7cfSm0udggeX6hnX0HClwBC5sKZ9wyad9QMz+4q5tjdMjonUNyJZ6e45tKeOQpNh5IY7nWcTsaxCGM0v84e/fPSnJA84PstSyPAKyyvtPkTkHFCrfIS+Y/KpIeaKMCL/Jcj9/Dtl87/B9DU/BBOdRS7kYbIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ç±»å‹é”™è¯¯\"\n        title=\"\"\n        src=\"/static/64cdeb47ab36016f60e175cf6e0fce07/8c557/error-example.png\"\n        srcset=\"/static/64cdeb47ab36016f60e175cf6e0fce07/4edbd/error-example.png 175w,\n/static/64cdeb47ab36016f60e175cf6e0fce07/13ae7/error-example.png 350w,\n/static/64cdeb47ab36016f60e175cf6e0fce07/8c557/error-example.png 700w,\n/static/64cdeb47ab36016f60e175cf6e0fce07/d30ee/error-example.png 980w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>","excerpt":"åœ¨Reactä¸­ï¼Œæ— è®ºæ˜¯å¦ä½¿ç”¨äº†Reduxæˆ–å…¶ä»–çŠ¶æ€ç®¡ç†æ¡†æ¶ï¼Œéƒ½æ— æ³•é¿å…åœ¨ç»„ä»¶ä¸­å¤„ç†å¼‚æ­¥è¯·æ±‚ã€‚åœ¨ä¸ä½¿ç”¨React Hooksçš„æƒ…å†µä¸‹ï¼Œå…¶å…¸å‹çš„æµç¨‹ä¸ºï¼š åœ¨componentDidMountä¸­å‘èµ·å¼‚æ­¥è¯·æ±‚ è°ƒç”¨setStateåœ¨stateä¸­ç»´æŠ¤è¯·æ±‚çš„loadingçŠ¶æ€ï¼Œå¹¶æ ¹æ®æ­¤çŠ¶æ€æ¸²æŸ“åŠ è½½åŠ¨ç”» åœ¨å¼‚æ­¥è¯·æ±‚resolveçš„æ—¶å€™è°ƒç”¨setStateå°†æ•°æ®æ”¾åˆ°stateä¸­ï¼Œå¹¶å°†loadingçŠ¶æ€ç½®ä¸ºfalseâ€¦","frontmatter":{"date":"September 09, 2019","path":"/with-async-data","title":"åœ¨Reactä¸­å°†å¼‚æ­¥è¯·æ±‚æŠ½è±¡ä¸ºé«˜é˜¶ç»„ä»¶(Typescript)"}}},"pageContext":{}},"staticQueryHashes":["2560569871","3584596544","63159454"],"slicesMap":{}}