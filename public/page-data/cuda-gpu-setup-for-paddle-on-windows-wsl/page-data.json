{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/cuda-gpu-setup-for-paddle-on-windows-wsl","result":{"data":{"markdownRemark":{"html":"<h1>TL;DR</h1>\n<p><a href=\"https://github.com/PaddlePaddle/Paddle\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PaddlePaddle</a>æ˜¯ç™¾åº¦å‡ºå“çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ã€‚åŸºäºPaddlePaddleç™¾åº¦è¿˜æ¨å‡ºäº†<a href=\"https://github.com/PaddlePaddle/PaddleOCR\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PaddleOCR</a>ï¼Œ<a href=\"https://github.com/PaddlePaddle/PaddleNLP\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PaddleNLP</a>ï¼Œ<a href=\"https://github.com/PaddlePaddle/PaddleHub\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PaddleHub</a>ç­‰å®ç”¨çš„å·¥å…·ã€‚ä½œä¸ºæ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œ<code>PaddlePaddle</code>è‡ªç„¶ä¹Ÿåœ¨å¤šä¸ªå¹³å°æ”¯æŒåŸºäºGPUçš„æ¨¡å‹è®­ç»ƒå’Œæ¨ç†ï¼Œå…¶ä¸­ä¹ŸåŒ…æ‹¬Windowså¹³å°ã€‚å¦‚æœä½ æƒ³ä½¿ç”¨Windowsç³»ç»Ÿè®­ç»ƒç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œè€Œåˆæƒ³è·å¾—Linuxçš„å¼€å‘ä½“éªŒçš„è¯ï¼ŒWindows Subsystem for Linux (<code>WSL</code>)æ˜¾ç„¶æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚å¦‚ä»Šè‹±ä¼Ÿè¾¾çš„å®˜æ–¹æ˜¾å¡é©±åŠ¨å®˜æ–¹æ”¯æŒäº†åœ¨WSLç³»ç»Ÿå†…éƒ¨è°ƒç”¨CUDAï¼Œæœ¬æ–‡ä»‹ç»äº†å¦‚ä½•ä»é›¶å¼€å§‹æ­å»ºåŸºäºWSLå’Œ<code>PaddlePaddle</code>çš„GPUæ·±åº¦å­¦ä¹ ç¯å¢ƒã€‚</p>\n<p>æœ¬æ–‡ç¯å¢ƒ: <code>System: Windows 10, version 21H2</code>, <code>GPU: GTX 3070</code>, <code>nVidia driver: 516.01</code></p>\n<h1>1. å®‰è£…WSL</h1>\n<p>åœ¨å®‰è£…WSLä¹‹å‰éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæƒ³åœ¨WSLå†…ä½¿ç”¨CUDAï¼Œéœ€è¦ç¡®ä¿Windowsç‰ˆæœ¬æ˜¯<code>Windows 11</code>æˆ–è€…è‡³å°‘<code>Windows 10, version 21H2</code>ã€‚å…·ä½“çš„è¦æ±‚å¯ä»¥å‚è€ƒ<a href=\"https://docs.microsoft.com/en-us/windows/ai/directml/gpu-cuda-in-wsl\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å®˜æ–¹æ–‡æ¡£</a>ã€‚è€Œæ˜¾å¡é©±åŠ¨æ–¹é¢åˆ™æ˜¯è¦å®‰è£…åŒ…å«WSL CUDAé©±åŠ¨çš„<a href=\"https://www.nvidia.com/download/index.aspx\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å®˜æ–¹é©±åŠ¨</a></p>\n<p>æ‰“å¼€ç®¡ç†å‘˜æƒé™çš„PowerShellè¾“å…¥ä¸€ä¸‹å‘½ä»¤å³å¯å®‰è£…WSLï¼Œç›®å‰é»˜è®¤å®‰è£…çš„ç‰ˆæœ¬æ˜¯<code>Ubuntu 20.04 LTS</code>ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ç›®å‰ä¸ºäº†åœ¨WSLé‡Œä½¿ç”¨CUDA,éœ€è¦å®‰è£…åŸºäº<code>glibc</code>çš„Linuxå‘è¡Œï¼Œé»˜è®¤çš„Ubuntuæ˜¯æ»¡è¶³è¦æ±‚çš„ã€‚</p>\n<pre><code class=\"language-bash\">wsl --install\n</code></pre>\n<p>å®‰è£…å®Œæ¯•åä½¿ç”¨<code>wsl --status</code>å‘½ä»¤å¯è·å–å½“å‰WSLçš„å®‰è£…ä¿¡æ¯ï¼Œéœ€è¦ç¡®ä¿å®‰è£…çš„ç‰ˆæœ¬æ˜¯WSL2ï¼Œå¦‚æœä»æ˜¯WSL1.Xï¼Œå¯ä½¿ç”¨<code>wsl --set-default-version 2</code>å‘½ä»¤å°†é»˜è®¤ç‰ˆæœ¬åˆ‡æ¢è‡³WSL2åé‡æ–°å®‰è£…ã€‚</p>\n<pre><code class=\"language-bash\">> wsl --status\n# é»˜è®¤åˆ†å‘ï¼šUbuntu\n# é»˜è®¤ç‰ˆæœ¬ï¼š2\n</code></pre>\n<p>WSLå®‰è£…å®Œæ¯•åè¿›å…¥Linuxå­ç³»ç»Ÿï¼Œæ­¤æ—¶å› ä¸ºå®¿ä¸»æœºå·²ç»å®‰è£…äº†WSLæ˜¾å¡é©±åŠ¨ï¼Œåœ¨wslå†…éƒ¨è¾“å…¥<code>nvidia-smi</code>å·²ç»å¯ä»¥è·å–GPUä¿¡æ¯</p>\n<pre><code class=\"language-bash\">> nvidia-smi\n# +-----------------------------------------------------------------------------+\n# | NVIDIA-SMI 515.43.04    Driver Version: 516.01       CUDA Version: 11.7     |\n# |-------------------------------+----------------------+----------------------+\n# | GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n# | Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n# |                               |                      |               MIG M. |\n# |===============================+======================+======================|\n# |   0  NVIDIA GeForce ...  On   | 00000000:08:00.0  On |                  N/A |\n# |  0%   47C    P8    11W / 198W |   1672MiB /  8192MiB |      2%      Default |\n# |                               |                      |                  N/A |\n# +-------------------------------+----------------------+----------------------+\n                                                                               \n# +-----------------------------------------------------------------------------+\n# | Processes:                                                                  |\n# |  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n# |        ID   ID                                                   Usage      |\n# |=============================================================================|\n# |  No running processes found                                                 |\n# +-----------------------------------------------------------------------------+\n</code></pre>\n<h1>2. å®‰è£…CUDA Toolkit</h1>\n<p><a href=\"https://developer.nvidia.com/cuda-toolkit\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CUDA Toolkit</a>æ˜¯åˆ©ç”¨CUDAè¿›è¡ŒGPUåŠ é€Ÿçš„å¼€å‘ç¯å¢ƒ, è€Œ<code>CUDA</code>(ComputeUnified Device Architecture)æ˜¯ä¸€ç§ç”±NVIDIAæ¨å‡ºçš„é€šç”¨å¹¶è¡Œè®¡ç®—æ¶æ„ï¼Œè¯¥æ¶æ„ä½¿GPUèƒ½å¤Ÿè§£å†³å¤æ‚çš„è®¡ç®—é—®é¢˜ã€‚æ ¹æ®<a href=\"https://docs.nvidia.com/cuda/wsl-user-guide/index.html#getting-started-with-cuda-on-wsl\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å®˜æ–¹æ–‡æ¡£</a>ï¼ŒWindowsä¸‹å®‰è£…çš„GPUé©±åŠ¨ç¨‹åºå·²ç»é›†æˆäº†é»˜è®¤çš„CUDA Toolkitï¼Œä½†ä¸ºäº†é¿å…å®¿ä¸»æœºé©±åŠ¨æ›´æ”¹å¯¹WSLç¯å¢ƒäº§ç”Ÿå½±å“ï¼Œæœ€å¥½åœ¨WSLå†…éƒ¨ç‹¬ç«‹å®‰è£…ä¸€å¥—CUDA Toolkitã€‚</p>\n<p>é¦–å…ˆéœ€è¦åˆ é™¤è€çš„GPG key</p>\n<pre><code class=\"language-bash\">sudo apt-key del 7fa2af80\n</code></pre>\n<p>ç„¶åä½¿ç”¨å‘½ä»¤å®‰è£…ï¼Œç”±äºæœ¬æœºçš„GPUæ˜¯å®‰åŸ¹æ¶æ„çš„ï¼Œä»¥ä¸‹ç¤ºä¾‹æ˜¯åŸºäºCUDA 11.7ç‰ˆæœ¬çš„ã€‚<code>PaddlePaddle</code>å¯¹éå®‰åŸ¹æ¶æ„æ¨èå®‰è£…CUDA 10.2ï¼Œå…¶ä»–ç‰ˆæœ¬å®‰è£…åœ°å€å¯ä»¥<a href=\"https://developer.nvidia.com/cuda-downloads?target_os=Linux&#x26;target_arch=x86_64&#x26;Distribution=WSL-Ubuntu&#x26;target_version=2.0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è¿™é‡Œ</a>æŸ¥è¯¢ã€‚</p>\n<pre><code class=\"language-bash\"># ä¸‹è½½å¹¶å®‰è£…apt-pinningæ–‡ä»¶ï¼Œ\nwget https://developer.download.nvidia.com/compute/cuda/repos/wsl-ubuntu/x86_64/cuda-wsl-ubuntu.pin\nsudo mv cuda-wsl-ubuntu.pin /etc/apt/preferences.d/cuda-repository-pin-600\n# ä¸‹è½½å¹¶å®‰è£…CUDA Toolkit wslç‰ˆæœ¬åœ°å®‰è£…åŒ…ï¼Œéœ€è¦å°†ç‰ˆæœ¬æ›¿æ¢ä¸ºä½ å¸Œæœ›å®‰è£…çš„CUDAç‰ˆæœ¬\nwget https://developer.download.nvidia.com/compute/cuda/11.7.0/local_installers/cuda-repo-wsl-ubuntu-11-7-local_11.7.0-1_amd64.deb\nsudo dpkg -i cuda-repo-wsl-ubuntu-11-7-local_11.7.0-1_amd64.deb\n</code></pre>\n<p>å®‰è£…å®ŒdebåŒ…åå¦‚æœå‡ºç°å¦‚ä¸‹æç¤ºï¼Œé‚£ä¹ˆè¯·æŒ‰ç…§æç¤ºå®‰è£…GPG key</p>\n<pre><code>The public CUDA GPG key does not appear to be installed.\nTo install the key, run this command:\nsudo cp /var/cuda-repo-wsl-ubuntu-11-7-local/cuda-B81839D3-keyring.gpg /usr/share/keyrings/\n</code></pre>\n<p>æœ€åä½¿ç”¨<code>apt-get</code>å®‰è£…CUDA Toolkit</p>\n<pre><code class=\"language-bash\">sudo apt-get update\nsudo apt-get -y install cuda\n</code></pre>\n<h1>3. å®‰è£…cuDNN</h1>\n<p><a href=\"https://docs.nvidia.com/deeplearning/cudnn/install-guide/index.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">cuDNN</a>(NVIDIAÂ® CUDAÂ® Deep Neural Network library)æ˜¯ç”¨äºæ·±åº¦ç¥ç»ç½‘ç»œçš„GPUåŠ é€Ÿåº“ã€‚é™¤äº†<code>PaddlePaddle</code>å¤–ï¼Œå‡ ä¹å„å¤§æ·±åº¦å­¦ä¹ æ¡†æ¶å¦‚<code>Tensorflow</code>ï¼Œ<code>PyTorch</code>å‡æ”¯æŒ<code>cuDNN</code>ã€‚</p>\n<p>åœ¨å®‰è£…<code>cuDNN</code>ä¹‹å‰ï¼Œéœ€è¦å…ˆå®‰è£…<code>zlib</code>ç”¨äºå‹ç¼©/è§£å‹</p>\n<pre><code class=\"language-bash\">sudo apt-get install zlib1g\n</code></pre>\n<p>è€Œ<code>cuDNN</code>æœ¬èº«çš„å®‰è£…æ–‡ä»¶éœ€è¦å»<a href=\"https://developer.nvidia.com/cudnn\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å®˜ç½‘</a>æ‰‹åŠ¨ä¸‹è½½ï¼Œå› ä¸ºè‹±ä¼Ÿè¾¾è¦æ±‚åœ¨ä¸‹è½½cuDNNä¹‹å‰å…ˆæ³¨å†Œè´¦å·ï¼Œå¹¶ç»™ä¸‹è½½é“¾æ¥ç­¾å‘ä¸€ä¸ªç»‘å®šè´¦å·çš„tokenğŸ˜“åœ¨ä¸‹è½½é¡µé¢æˆ‘ä»¬é€‰æ‹©<code>Local Installer for Linux x86_64 (Tar)</code></p>\n<p>å‡è®¾æˆ‘ä»¬ä¸‹è½½çš„å‹ç¼©æ–‡ä»¶å«<code>cudnn-linux-x86_64-8.4.1.50_cuda11.6-archive.tar.xz</code>ï¼Œä¸‹è½½å®Œæˆåå…ˆè§£å‹</p>\n<pre><code class=\"language-bash\">tar -xvf cudnn-linux-x86_64-8.4.1.50_cuda11.6-archive.tar.xz\n</code></pre>\n<p>ç„¶åå°†å¯¹åº”çš„æ–‡ä»¶æ‹·è´åˆ°<code>/usr/local/cuda</code>ä¸‹</p>\n<pre><code class=\"language-bash\">sudo cp cudnn-*-archive/include/cudnn*.h /usr/local/cuda/include \nsudo cp -P cudnn-*-archive/lib/libcudnn* /usr/local/cuda/lib64 \nsudo chmod a+r /usr/local/cuda/include/cudnn*.h /usr/local/cuda/lib64/libcudnn*\n</code></pre>\n<p>è‡³æ­¤<code>cuDNN</code>å·²ç»å®‰è£…æˆåŠŸäº†ã€‚</p>\n<h1>4. åˆ©ç”¨Condaå®‰è£…Python</h1>\n<p><code>Conda</code>æ˜¯Pythonçš„ç‰ˆæœ¬å’Œç¯å¢ƒç®¡ç†å·¥å…·ï¼Œæœ‰äº›åƒNodeJSçš„<code>NVM</code>å’ŒRubyçš„<code>RVM</code>ã€‚Condaåˆ†ä¸ºMinicondaå’ŒAnacondaï¼Œå‰è€…ä»…åŒ…å«åŸºç¡€å†…å®¹ï¼Œè€Œåè€…åŒ…å«äº†ä¸€äº›å¸¸ç”¨çš„åŒ…åœ¨å†…ã€‚ä»¥Anacondaä¸ºä¾‹ï¼Œåœ¨<a href=\"https://www.anaconda.com/products/distribution\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å®˜ç½‘</a>å¯ä»¥æ‰¾åˆ°ä¸‹è½½é“¾æ¥ï¼Œå®é™…æ˜¯ä¸€æ®µè„šæœ¬ï¼Œå¯ä»¥ä¸‹è½½æ‰§è¡Œå®‰è£…</p>\n<pre><code class=\"language-bash\">curl -o- https://repo.anaconda.com/archive/Anaconda3-2022.05-Linux-x86_64.sh | bash\n</code></pre>\n<p>å®‰è£…å®Œåé‡æ–°æ‰“å¼€WSLç»ˆç«¯å°±å¯ä»¥è·å¾—Pythonç¯å¢ƒ(ç›®å‰é»˜è®¤æ˜¯3.9)ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºæ–°çš„Condaç¯å¢ƒä»¥åŠåœ¨ä¸åŒç‰ˆæœ¬çš„Pythoné—´åˆ‡æ¢ã€‚ä»‹ç»Condaä½¿ç”¨çš„æ–‡ç« æœ‰å¾ˆå¤šï¼Œè¿™é‡Œä¸åœ¨èµ˜è¿°ï¼Œå¯ä»¥å‚è€ƒ<a href=\"https://www.jianshu.com/p/edaa744ea47d\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">condaçš„å®‰è£…ä¸ä½¿ç”¨</a></p>\n<h1>5. å®‰è£…PaddlePaddleç¯å¢ƒ</h1>\n<p>PaddlePaddleæœ‰CPUç‰ˆå’ŒGPUç‰ˆï¼Œæˆ‘ä»¬è¿™æ¬¡è‡ªç„¶æ˜¯è¦å®‰è£…GPUç‰ˆæœ¬ã€‚ä»<a href=\"https://www.paddlepaddle.org.cn/install/quick?docurl=/documentation/docs/zh/install/pip/linux-pip.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å®˜ç½‘</a>å¯ä»¥è·å–ä½¿ç”¨<code>pip</code>æˆ–è€…<code>conda</code>å®‰è£…ä¸åŒç‰ˆæœ¬çš„æŒ‡ä»¤ã€‚ä»¥ç›®å‰CUDA 11.7ç‰ˆä¸ºä¾‹ï¼Œè™½ç„¶PaddlePaddleå½“å‰æœ€é«˜æ”¯æŒCUDA 11.2ï¼Œä½†CUDA 11.7å¯¹å…¶ä»ç„¶å…¼å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨pipå®‰è£…åŸºäºCUDA 11.2çš„<code>paddlepaddle-gpu</code>åŒ…å³å¯ã€‚</p>\n<pre><code class=\"language-bash\">pip install paddlepaddle-gpu==2.3.0.post112 -f https://www.paddlepaddle.org.cn/whl/linux/mkl/avx/stable.html\n</code></pre>\n<p>ä¸ºäº†éªŒè¯å®‰è£…ï¼Œæˆ‘ä»¬åœ¨WSLè¾“å…¥<code>python</code>è¿›å…¥äº¤äº’å¼Pythonç¯å¢ƒï¼Œè¾“å…¥<code>import paddle</code> ï¼Œå›è½¦åå†è¾“å…¥<code>paddle.utils.run_check()</code>ã€‚å¦‚æœæ‰“å°ä¿¡æ¯æ˜¾ç¤º</p>\n<pre><code class=\"language-python\">Python 3.9.12 (main, Apr  5 2022, 06:56:58) \n[GCC 7.5.0] :: Anaconda, Inc. on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import paddle\n>>> paddle.utils.run_check()\nRunning verify PaddlePaddle program ... \nW0614 17:12:36.941226  2519 gpu_context.cc:278] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 11.7, Runtime API Version: 11.2\nW0614 17:12:36.967586  2519 gpu_context.cc:306] device: 0, cuDNN Version: 8.4.\nPaddlePaddle works well on 1 GPU.\nPaddlePaddle works well on 1 GPUs.\nPaddlePaddle is installed successfully! Let's start deep learning with PaddlePaddle now.\n>>> \n</code></pre>\n<p>é‚£ä¹ˆä»£è¡¨PaddlePaddle GPUç¯å¢ƒå·²ç»å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥åœ¨æ˜¾å¡ä¸Šè¿›è¡Œæ·±åº¦å­¦ä¹ çš„å·¥ä½œäº†ã€‚ä½†å¦‚æœå‡ºç°æŸäº›æ–‡ä»¶ç¼ºå¤±ï¼Œæ¯”å¦‚è¿™é‡Œæç¤º<code>libcuda.so</code>æ‰¾ä¸åˆ°</p>\n<pre><code>The third-party dynamic library (libcuda.so) that Paddle depends on is not configured correctly. (error code is libcuda.so: cannot open shared object file: No such file or directory)\n</code></pre>\n<p>é‚£å¾ˆæœ‰å¯èƒ½æ˜¯æŸäº›ä¾èµ–æ–‡ä»¶é€šè¿‡WSLæ³¨å…¥Linuxç¯å¢ƒåï¼Œæ²¡æœ‰è¢«åŠ å…¥åŠ¨æ€/å…±äº«åº“çš„è·¯å¾„ä¸­ã€‚</p>\n<p>é¦–å…ˆåœ¨<code>/usr</code>è·¯å¾„ä¸‹å¯»æ‰¾è¯¥æ–‡ä»¶</p>\n<pre><code class=\"language-bash\">> sudo sudo find /usr/ -name 'libcuda.so'\n# /usr/lib/wsl/lib/libcuda.so\n</code></pre>\n<p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªä¾èµ–å…¶å®å·²ç»åœ¨<code>/usr/lib/wsl/lib/libcuda.so</code>è¿™ä¸ªè·¯å¾„ä¸‹äº†ï¼Œåªæ˜¯PaddlePaddleæ— æ³•ä»<code>LD_LIBRARY_PATH</code>ä¸­æ‰¾åˆ°å®ƒã€‚é‚£åªéœ€è¦æŠŠ<code>/usr/lib/wsl/lib</code>è¿™ä¸ªè·¯å¾„åŠ å…¥åˆ°<code>LD_LIBRARY_PATH</code>å³å¯ã€‚</p>\n<pre><code class=\"language-bash\">export LD_LIBRARY_PATH=/usr/lib/wsl/lib:$LD_LIBRARY_PATH\n</code></pre>\n<h1>5. ä½¿ç”¨PaddleOCRéªŒè¯GPUç¯å¢ƒ</h1>\n<p><a href=\"https://github.com/PaddlePaddle/PaddleOCR\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PaddleOCR</a>æ˜¯ç™¾åº¦çš„å¼€æºOCRå·¥å…·åº“ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ä½¿ç”¨GPUè·‘ä¸€ä¸ªPaddleOCRçš„ç«¯å¯¹ç«¯OCRæ¨ç†æ¥éªŒè¯ä¸€ä¸‹ç¯å¢ƒæ˜¯å¦æ­å»ºæˆåŠŸã€‚</p>\n<p>é¦–å…ˆå°†PaddleOCRæ‹‰åˆ°æœ¬åœ°å¹¶è¿›å…¥é¡¹ç›®ç›®å½•</p>\n<pre><code class=\"language-bash\">git clone git@github.com:PaddlePaddle/PaddleOCR.git\n\ncd PaddleOCR\n</code></pre>\n<p>PaddleOCRä¸­æœ‰åŒ…æ‹¬ç›®æ ‡æ£€æµ‹ï¼Œæ–‡å­—è¯†åˆ«ï¼Œå…³é”®ä¿¡æ¯æå–ç­‰è¯¸å¤šå·¥å…·ã€‚æˆ‘ä»¬è¿™æ¬¡ä½¿ç”¨æœ€ç›´è§‚çš„ç«¯åˆ°ç«¯OCRï¼Œå³è¾“å…¥å›¾ç‰‡ï¼Œè¾“å‡ºæ–‡å­—çš„æ¨¡å‹ã€‚ç›¸å…³çš„è¯´æ˜æ–‡æ¡£åœ¨è¿™ä¸ªä½ç½®<code>doc/doc_ch/algorithm_e2e_pgnet.md</code></p>\n<p>é¦–å…ˆéœ€è¦ä¸‹è½½ä¸è®­ç»ƒå¥½çš„æ¨¡å‹ï¼š</p>\n<pre><code class=\"language-bash\">mkdir inference &#x26;&#x26; cd inference\n# ä¸‹è½½è‹±æ–‡ç«¯åˆ°ç«¯æ¨¡å‹å¹¶è§£å‹\nwget https://paddleocr.bj.bcebos.com/dygraph_v2.0/pgnet/e2e_server_pgnetA_infer.tar &#x26;&#x26; tar xf e2e_server_pgnetA_infer.tar\n</code></pre>\n<p>è§£å‹åçš„æ–‡ä»¶ç›®å½•ç»“æ„ä¸ºï¼š</p>\n<pre><code class=\"language-bash\">â”œâ”€â”€ e2e_server_pgnetA_infer\nâ”‚   â”œâ”€â”€ inference.pdiparams\nâ”‚   â”œâ”€â”€ inference.pdiparams.info\nâ”‚   â””â”€â”€ inference.pdmodel\n</code></pre>\n<p>å…¶ä¸­æ¯”è¾ƒå…³é”®çš„ä¸¤ä¸ªæ–‡ä»¶ä¸º<code>inference.pdmodel</code>ä»¥åŠ<code>inference.pdiparams</code>ï¼Œå‰è€…å‚¨å­˜äº†æ•´ä¸ªç¥ç»ç½‘ç»œæ¨¡å‹çš„ç»“æ„ï¼Œè€Œåè€…å‚¨å­˜äº†å„å±‚è®­ç»ƒå®Œåçš„æƒé‡å‚æ•°ã€‚å¦‚æœä½ æƒ³å¯è§†åŒ–åœ°æµè§ˆæ•´ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨<a href=\"https://netron.app/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Netron</a>è¿™ä¸ªå·¥å…·æ‰“å¼€è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ•´ä¸ªæ¨¡å‹çš„ç»“æ„å°±ä¸€è§ˆæ— ä½™äº†ã€‚\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.57142857142857%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA2klEQVR42o2R207DMBBE/UWkaq5FivfSKJSn/P/XDLMboISqgoeRvGvv+HhcVBW7ZJcZ7r3nMmqeZwzDgPZ8xkvToKFKbLopxFeILZTsAzT+SyKShmnatui6DsXYtKTzVBz6FyENg3AcR0zTlKaxLuYLlHTqpLR4ih2GnsndUWtF3/dHQzVSJR0NHzKUX7lJZpc1z9XKDB8MSRj5qX0SBkEM+hXV37hneZHz4qg1yHjuGp+iC3Mb8Hq5fD+9iNoPQr0THPqyf8JXHbnTtIqiOZ2wriu2bcP77YYPBs3yH12vFfMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Netron\"\n        title=\"\"\n        src=\"/static/3d2ca5a3f3b575f8b573fa212b0f24dd/8c557/netron.png\"\n        srcset=\"/static/3d2ca5a3f3b575f8b573fa212b0f24dd/4edbd/netron.png 175w,\n/static/3d2ca5a3f3b575f8b573fa212b0f24dd/13ae7/netron.png 350w,\n/static/3d2ca5a3f3b575f8b573fa212b0f24dd/8c557/netron.png 700w,\n/static/3d2ca5a3f3b575f8b573fa212b0f24dd/e996b/netron.png 1050w,\n/static/3d2ca5a3f3b575f8b573fa212b0f24dd/2cefc/netron.png 1400w,\n/static/3d2ca5a3f3b575f8b573fa212b0f24dd/e0dbc/netron.png 3378w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ä¸‹è½½å®Œæ¨¡å‹åï¼Œå›åˆ°PaddleOCRçš„æ ¹ç›®å½•ï¼Œå°±å¯ä»¥ä½¿ç”¨å®˜æ–¹æä¾›çš„å·¥å…·å¯¹æµ‹è¯•æ•°æ®è¿›è¡Œæ‰¹é‡è¯†åˆ«äº†:</p>\n<pre><code class=\"language-bash\">> python3 tools/infer/predict_e2e.py --e2e_algorithm=\"PGNet\" --image_dir=\"./doc/imgs_en/\" --e2e_model_dir=\"./inference/e2e_server_pgnetA_infer/\" --e2e_pgnet_valid_set=\"totaltext\"\n# [2022/06/16 16:24:31] ppocr INFO: Predict time of ./doc/imgs_en/254.jpg: 5.411184072494507\n# [2022/06/16 16:24:31] ppocr INFO: The visualized image saved in ./inference_results/e2e_res_254.jpg\n# [2022/06/16 16:24:31] ppocr INFO: Predict time of ./doc/imgs_en/img623.jpg: 0.08095073699951172\n# [2022/06/16 16:24:31] ppocr INFO: The visualized image saved in ./inference_results/e2e_res_img623.jpg\n# [2022/06/16 16:24:31] ppocr INFO: Predict time of ./doc/imgs_en/img_10.jpg: 0.09116768836975098\n# [2022/06/16 16:24:31] ppocr INFO: The visualized image saved in ./inference_results/e2e_res_img_10.jpg\n# [2022/06/16 16:24:31] ppocr INFO: Predict time of ./doc/imgs_en/img_11.jpg: 0.07429361343383789\n# [2022/06/16 16:24:31] ppocr INFO: The visualized image saved in ./inference_results/e2e_res_img_11.jpg\n# [2022/06/16 16:24:32] ppocr INFO: Predict time of ./doc/imgs_en/img_12.jpg: 0.10506463050842285\n# [2022/06/16 16:24:32] ppocr INFO: The visualized image saved in ./inference_results/e2e_res_img_12.jpg\n# [2022/06/16 16:24:32] ppocr INFO: Predict time of ./doc/imgs_en/img_195.jpg: 0.0799555778503418\n# [2022/06/16 16:24:32] ppocr INFO: The visualized image saved in ./inference_results/e2e_res_img_195.jpg\n# [2022/06/16 16:24:32] ppocr INFO: Predict time of ./doc/imgs_en/model_prod_flow_en.png: 0.07767033576965332\n# [2022/06/16 16:24:32] ppocr INFO: The visualized image saved in ./inference_results/e2e_res_model_prod_flow_en.png\n# [2022/06/16 16:24:32] ppocr INFO: Predict time of ./doc/imgs_en/wandb_metrics.png: 0.14113736152648926\n# [2022/06/16 16:24:32] ppocr INFO: The visualized image saved in ./inference_results/e2e_res_wandb_metrics.png\n# [2022/06/16 16:24:32] ppocr INFO: Predict time of ./doc/imgs_en/wandb_models.png: 0.15174198150634766\n# [2022/06/16 16:24:32] ppocr INFO: The visualized image saved in ./inference_results/e2e_res_wandb_models.png\n# [2022/06/16 16:24:32] ppocr INFO: Avg Time: 0.10024774074554443\n</code></pre>\n<p>åœ¨è¯†åˆ«çš„è¿‡ç¨‹ä¸­ï¼Œåœ¨å¦ä¸€ä¸ªç»ˆç«¯ä½¿ç”¨<code>nvidia-smi</code>ï¼Œå°±èƒ½çœ‹åˆ°ä¸€ä¸ªpythonä»»åŠ¡æ­£åœ¨å ç”¨GPUï¼š</p>\n<pre><code class=\"language-bash\">> nvidia-smi\n# Thu Jun 16 16:24:30 2022       \n# +-----------------------------------------------------------------------------+\n# | NVIDIA-SMI 515.43.04    Driver Version: 516.01       CUDA Version: 11.7     |\n# |-------------------------------+----------------------+----------------------+\n# | GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n# | Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n# |                               |                      |               MIG M. |\n# |===============================+======================+======================|\n# |   0  NVIDIA GeForce ...  On   | 00000000:08:00.0  On |                  N/A |\n# |  0%   48C    P8    16W / 198W |   3412MiB /  8192MiB |     21%      Default |\n# |                               |                      |                  N/A |\n# +-------------------------------+----------------------+----------------------+\n                                                                               \n# +-----------------------------------------------------------------------------+\n# | Processes:                                                                  |\n# |  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n# |        ID   ID                                                   Usage      |\n# |=============================================================================|\n# |    0   N/A  N/A      9129      C   /python3.9                      N/A      |\n</code></pre>\n<p>æ‰“å¼€ä¿å­˜ç»“æœçš„ç›®å½•<code>inference_results</code>å°±èƒ½çœ‹åˆ°è¯†åˆ«çš„ç»“æœäº†\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d2052b16c2796a9e33920a2a6f7a796a/ba579/e2e_res_img_12.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.28571428571429%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEEA//EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAGpVtJDYX//xAAZEAACAwEAAAAAAAAAAAAAAAAAEAECEhH/2gAIAQEAAQUCmpkwuL//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAaEAACAwEBAAAAAAAAAAAAAAAAAREhQTGR/9oACAEBAAE/IaUK++kCE+kFhrP/2gAMAwEAAgADAAAAEMj/AP/EABYRAQEBAAAAAAAAAAAAAAAAAAEQEf/aAAgBAwEBPxBHZ//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAQACAwEBAAAAAAAAAAAAAAEAESExQWGR/9oACAEBAAE/EBNxnjUNJa8YzOOwIUubQLi/af/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ocr_res\"\n        title=\"\"\n        src=\"/static/d2052b16c2796a9e33920a2a6f7a796a/29d31/e2e_res_img_12.jpg\"\n        srcset=\"/static/d2052b16c2796a9e33920a2a6f7a796a/e52aa/e2e_res_img_12.jpg 175w,\n/static/d2052b16c2796a9e33920a2a6f7a796a/70ebb/e2e_res_img_12.jpg 350w,\n/static/d2052b16c2796a9e33920a2a6f7a796a/29d31/e2e_res_img_12.jpg 700w,\n/static/d2052b16c2796a9e33920a2a6f7a796a/9ecec/e2e_res_img_12.jpg 1050w,\n/static/d2052b16c2796a9e33920a2a6f7a796a/d165a/e2e_res_img_12.jpg 1400w,\n/static/d2052b16c2796a9e33920a2a6f7a796a/ba579/e2e_res_img_12.jpg 1680w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h1>6. It's all setup, happy deep learning!</h1>\n<p>æœ€ååˆ«å¿˜è®°å®‰è£…VScodeçš„<a href=\"https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-wsl\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WSL remoteæ’ä»¶</a>äº†, happy deep learning!</p>\n<h3>å‚è€ƒé“¾æ¥</h3>\n<ol>\n<li><a href=\"https://docs.microsoft.com/en-us/windows/ai/directml/gpu-cuda-in-wsl\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.microsoft.com/en-us/windows/ai/directml/gpu-cuda-in-wsl</a></li>\n<li><a href=\"https://docs.nvidia.com/cuda/wsl-user-guide/index.html#getting-started-with-cuda-on-wsl\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.nvidia.com/cuda/wsl-user-guide/index.html#getting-started-with-cuda-on-wsl</a></li>\n<li><a href=\"https://docs.nvidia.com/deeplearning/cudnn/install-guide/index.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.nvidia.com/deeplearning/cudnn/install-guide/index.html</a></li>\n<li><a href=\"https://www.paddlepaddle.org.cn/install/quick?docurl=/documentation/docs/zh/install/pip/linux-pip.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.paddlepaddle.org.cn/install/quick?docurl=/documentation/docs/zh/install/pip/linux-pip.html</a></li>\n<li><a href=\"https://www.jianshu.com/p/edaa744ea47d\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.jianshu.com/p/edaa744ea47d</a></li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/463235082\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://zhuanlan.zhihu.com/p/463235082</a></li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/83971195\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://zhuanlan.zhihu.com/p/83971195</a></li>\n</ol>","excerpt":"TL;DR PaddlePaddleæ˜¯ç™¾åº¦å‡ºå“çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ã€‚åŸºäºPaddlePaddleç™¾åº¦è¿˜æ¨å‡ºäº†PaddleOCRï¼ŒPaddleNLPï¼ŒPaddleHubç­‰å®ç”¨çš„å·¥å…·ã€‚ä½œä¸ºæ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ŒPaddlePaddleè‡ªç„¶ä¹Ÿåœ¨å¤šä¸ªå¹³å°æ”¯æŒåŸºäºGPUçš„æ¨¡å‹è®­ç»ƒå’Œæ¨ç†ï¼Œå…¶ä¸­ä¹ŸåŒ…æ‹¬Windowså¹³å°ã€‚å¦‚æœä½ æƒ³ä½¿ç”¨Windowsç³»ç»Ÿè®­ç»ƒç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œè€Œåˆæƒ³è·å¾—Linuxçš„å¼€å‘ä½“éªŒçš„è¯ï¼ŒWindows Subsystem for Linux (WSLâ€¦","frontmatter":{"date":"June 13, 2022","path":"/cuda-gpu-setup-for-paddle-on-windows-wsl","title":"Windowsç¯å¢ƒä¸‹åˆ©ç”¨WSLæ­å»ºGPUè®­ç»ƒ/æ¨ç†PaddlePaddleç¥ç»ç½‘ç»œç¯å¢ƒ"}}},"pageContext":{}},"staticQueryHashes":["2560569871","3584596544","63159454"],"slicesMap":{}}